!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Lines=e():t.Lines=e()}(window,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=3)}([function(t,e){function n(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function r(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(r,!0).forEach((function(e){i(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(r).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var a={init:{},line:{},candle:{},ema:{},sma:{}},c=JSON.parse(JSON.stringify(a)),l={save:function(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1];var e=l.validate(t)?t:l.dataFormatter(t);l.mset({raw:e,labels:e.map((function(t){return t[4]})),data:e.map((function(t){return t[3]}))}),l.set("data",e.map((function(t){return t[3]})),"line")},all:function(){return c},get:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"init";return c[e][t]},mget:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"init",n={};return t.forEach((function(t){n[t]=c[e][t]})),n},init:function(t){var e=o(t.split("."),2),n=e[0],r=e[1];return r?(!c[n]&&(c[n]={}),!c[n][r]&&(c[n][r]=[])):!c[n]&&(c[n]=[]),r?[n,r]:[n]},push:function(t,e){var n=l.init(t);n[1]?c[n[0]][n[1]].push(e):c[n[0]].push(e)},set:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"init";c[n][t]=e},mset:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"init";c[e]=r({},c[e],{},t)},validate:function(t){return t.every((function(t){return!t.date||!t.high}))},dataFormatter:function(t){return t.map((function(t){return[t.open,t.high,t.low,t.close,t.date]}))},reset:function(){c=JSON.parse(JSON.stringify(a))}};t.exports=l},function(t,e){function n(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var i,o;t.exports=(i=0,o=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?n(i,!0).forEach((function(e){r(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):n(i).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},{f:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return Math.abs(parseFloat(t).toFixed(e))},fDate:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1d",n=new Date(t);return"15m"===e?n.getHours()+":"+n.getMinutes():"1d"===e?"".concat(o[n.getMonth()],"'").concat(n.getDate()):void 0},candle:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"body",n={body:["x","y","width","height","isWin"],shadow:["top","bottom","isWin"]};return Object.keys(t).filter((function(t){return n[e].includes(t)})).reduce((function(e,n){return e[n]=t[n],e}),{})},genId:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"line";return++i,"".concat(t,"-").concat(i)}}))},function(t,e){t.exports={config:{debug:!1,chart:{type:["line","candle","sma","ema"],paddingX:30,paddingY:30,enableGrid:!0,candleFill:.4,totalGrids:5,labelXskipLength:21},svg:{line:{stroke:"#505050",strokeWidth:3,class:"liveLine",cursor:"pointer"},path:{stroke:"#36a2eb"},rectGroup:{candleWin:{stroke:"#f00",fill:"#f00",id:"candleWin"},candleLose:{stroke:"#00f",fill:"#00f",id:"candleLose"}},rect:{lnav:{cursor:"pointer",fill:"#828282"}},circle:{cursor:{fill:"#388E3C",strokeWidth:9,stroke:"#00bcd480",id:"liveCursor"},lnav:{class:"lnav",r:6},lcir:{cursor:"pointer",fill:"#828282"}}},colors:{candleWin:"f00",candleLose:"00f",grid:"ddd",line:"36a2eb",sma:"ff9f40",ema:"9966ff",cursor:{fill:"388E3C",stroke:"00bcd480"},lline:"505050"},smaLength:5,emaLength:10,magnetMode:50,step:{x:50,xMin:20,xMax:100,yMax:20,arrow:50,zoom:9,offset:9,xLegend:100},timeUnit:"15m",timeUnits:["15m","30m","1h","4h","1d","1w"],drawOrder:["drawLine","drawCandle","drawSMA","drawEMA"]},SVG:{line:"line",text:"text",rect:"rect",circle:"circle",path:"path",input:"input"},CHART:{axis:"axis",line:"line",candle:"candle",legend:"legend",debug:"debug",sinit:"sinit",init:"init",sma:"sma",ema:"ema"},DRAW:{line:"line",rect:"rect",text:"text",circle:"circle",pointer:"pointer"}}},function(t,e,n){var r=n(4),i=n(2),o=i.CHART,a=i.DRAW,c=i.config,l=function(){var t=function(t){if(!window.Snap)throw new Error("Missing Snap.svg library !");this.chart=new r(t)};return t.prototype.data=function(t){this.chart.data(t)},t.prototype.draw=function(t){switch(t){case o.axis:this.chart.drawAxis();break;case o.line:this.chart.drawLine();break;case o.candle:this.chart.drawCandle();break;case o.sma:this.chart.drawSma();break;case o.ema:this.chart.drawEma();break;default:this.chart.drawAxis(),this.chart.drawCandle(),this.chart.drawLine(),this.chart.drawSma(),this.chart.drawEma()}},t.prototype.getImage=function(){return this.chart.getImage()},t.prototype.toggle=function(t){c.chart.type.includes(t)&&this.chart.toggle(t)},t.prototype.cursor=function(){this.chart.cursor()},t.prototype.live=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"line";switch(t){case a.line:this.chart.liveLine();break;case a.rect:this.chart.liveRect();break;case a.text:this.chart.liveText();break;case a.circle:this.chart.liveCircle();break;case a.pointer:this.chart.livePointer()}},t.prototype.redraw=function(){this.chart.redraw()},t.prototype.next=function(t){this.chart.next(t)},t}();void 0!==t.exports?t.exports=l:window.Lines=l},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var l=n(0),u=n(1),s=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o(this,a(e).apply(this,arguments))}var n,r,s;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(e,t),n=e,(r=[{key:"cursor",value:function(){var t=this;if(this.getId("liveCursor"))return this.getId("liveCursor").remove(),void this.getId("liveText").remove();var e=this.calc.findY(230),n=this.svgDot([230,e.pixel],"cursor"),r=l.mget(["area","zeroX"]),i=r.area.offsetLeft,o=r.zeroX,a=this.svgText({point:[o,e.pixel],label:e.value},"liveText");this.snap.unmousemove(),this.snap.mousemove((function(e,r){return t.cursorMove(r,{cursorElem:n,labelElem:a,offsetLeft:i})}))}},{key:"cursorMove",value:function(t,e){var n=e.cursorElem,r=e.labelElem;if(!((t-=e.offsetLeft)%5)){var i=this.calc.findY(t);i&&(n.attr({cx:t,cy:i.pixel}),r.node.innerHTML=i.value,r.attr({y:i.pixel}))}}},{key:"liveLine",value:function(){var t,e=this,n=(arguments.length>0&&void 0!==arguments[0]&&arguments[0],u.genId());this.liveMove((function(r,i){"start"===r?t=e.svgLine(i,i,n):"move"===r?t.attr({x2:i[0],y2:i[1]}):"end"===r&&(t.click((function(){return e.liveLineClick.call(e,n)})),t.dblclick((function(){return t.remove()})))}))}},{key:"liveLineClick",value:function(t){var e=this;if(!this.liveDotDelete(t)){var n=this.getIdAttr(t,["x1","x2","y1","y2"]),r=n.x1,i=n.x2,o={points:[[r,n.y1],[i,n.y2]]};o.elem=this.svgDot(o.points[0],"lnav","".concat(t,"-nav1")),o.elem1=this.svgDot(o.points[1],"lnav","".concat(t,"-nav2"));var a=function(){e.delete([o.elem,o.elem1])},c=this.getIdSnap(t);this.liveDot(o.elem,(function(t){c.attr({x1:t[0],y1:t[1]})}),a),this.liveDot(o.elem1,(function(t){c.attr({x2:t[0],y2:t[1]})}),a)}}},{key:"liveRect",value:function(){var t,e,n=this;e=u.genId("rect");var r={};this.liveMove((function(i,o){"start"===i?(r=n.calc.liveRect(o),t=n.svgRect(r,"lnav",e)):"move"===i?t.attr(n.calc.liveRect(o,r)):"end"===i&&(t.click((function(){return n.liveRectClick.call(n,e)})),t.dblclick((function(){return t.remove()})))}))}},{key:"liveRectClick",value:function(t){var e=this;if(!this.liveDotDelete(t)){var n=this.getIdAttr(t,["x","y","width","height"]),r=n.x,i=n.y,o=n.width,a=n.height,c={points:[[r,i],[r+o,i+a]]};c.elem=this.svgDot(c.points[0],"lnav","".concat(t,"-nav1")),c.elem1=this.svgDot(c.points[1],"lnav","".concat(t,"-nav2"));var l=function(){e.delete([c.elem,c.elem1])},u=this.getIdSnap(t);this.liveDot(c.elem,(function(t){u.attr({x:t[0],y:t[1]}),c.elem1.attr({cx:t[0]+o,cy:t[1]+a})}),l),this.liveDot(c.elem1,(function(t){u.attr(e.calc.liveRect(t,{x:r,y:i,width:o,height:a}))}),l)}}},{key:"liveCircle",value:function(){var t,e,n=this,r=u.genId("circle");this.liveMove((function(i,o){"start"===i?(e=o,t=n.svgDot(e,"lcir",r)):"move"===i?t.attr(n.calc.liveCircle(o,e)):"end"===i&&(t.click((function(){return n.liveCircleClick.call(n,r)})),t.dblclick((function(){return t.remove()})))}))}},{key:"liveCircleClick",value:function(t){var e=this;if(!this.liveDotDelete(t)){var n=this.getIdAttr(t,["cx","cy","r"]),r=n.cx,i=n.cy,o=n.r,a={points:[[r,i],[r+o,i]]};a.elem=this.svgDot(a.points[0],"lnav","".concat(t,"-nav1")),a.elem1=this.svgDot(a.points[1],"lnav","".concat(t,"-nav2"));var c=function(){e.delete([a.elem,a.elem1])},l=this.getIdSnap(t);this.liveDot(a.elem,(function(t){l.attr({cx:t[0],cy:t[1]}),a.elem1.attr({cx:t[0]+o,cy:t[1]})}),c),this.liveDot(a.elem1,(function(t){l.attr(e.calc.liveCircle(t,[r,i]))}),c)}}},{key:"livePointer",value:function(t){var e,n,r,i=this,o=u.genId("pointer"),a=u.genId("ptext");this.liveMove((function(t,c){if("start"===t)r=[c[0],i.calc.findY(c[0]).pixel],e=i.svgLine(r,r,o),n=i.svgText({point:r,label:i.calc.findY(c[0]).value},a);else if("move"===t){var l=i.calc.livePointer(c);n.attr({x:l.x2,y:l.y2}),n.node.innerHTML=l.foundY.value,delete l.foundY,e.attr(l)}else"end"===t&&e.click((function(){return i.livePointerClick.call(i,o,a)}))}))}},{key:"livePointerClick",value:function(t,e){var n=this;if(!this.liveDotDelete(t)){var r=this.getIdAttr(t,["x2","y2"]),i={points:[[r.x2,r.y2]]};i.elem=this.svgDot(i.points[0],"lnav","".concat(t,"-nav1"));var o=this.getIdSnap(t),a=this.getIdSnap(e);this.liveDot(i.elem,(function(t){var e=n.calc.livePointer(t);a.attr({x:e.x2,y:e.y2}),a.node.innerHTML=e.foundY.value,delete e.foundY,o.attr(e)}),(function(){n.delete([i.elem])}))}}},{key:"liveText",value:function(){var t,e=this,n=u.genId("text");this.liveMove((function(r,i){"start"===r?(e.textSvg(i,n),t=e.getIdSnap(n)):"move"===r?t.attr({x:i[0],y:i[1]}):"end"===r&&(t.click((function(){return e.liveTextClick.call(e,n)})),t.dblclick((function(){return t.remove()})))}))}},{key:"liveTextClick",value:function(t){var e=this;if(!this.liveDotDelete(t)){var n=this.getIdAttr(t,["x","y","width","height"]),r=n.x,i=n.y,o=n.width,a=n.height,c={points:[[r,i],[r+o,i+a]]};c.elem=this.svgDot(c.points[0],"lnav","".concat(t,"-nav1")),c.elem1=this.svgDot(c.points[1],"lnav","".concat(t,"-nav2")),c.finishCb=function(){e.delete([c.elem,c.elem1])};var l=this.getIdSnap(t);this.liveDot(c.elem,(function(t){l.attr({x:t[0],y:t[1]}),c.elem1.attr({cx:t[0]+o,cy:t[1]+a})}),c.finishCb),this.liveDot(c.elem1,(function(t){console.log("width : ",o,a);var e={width:t[0]-r,height:t[1]-i};l.attr(e)}),c.finishCb)}}},{key:"redraw",value:function(){var t=l.get("raw");this.deleteAll(),l.reset(),this.setup(),this.data(t),this.drawAll()}},{key:"next",value:function(t){this.deleteAll(),l.reset(),this.setup(),this.data(t),this.drawAll()}}])&&i(n.prototype,r),s&&i(n,s),e}(n(5));t.exports=s},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var l=n(0),u=n(1),s=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o(this,a(e).apply(this,arguments))}var n,r,s;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(e,t),n=e,(r=[{key:"drawCandle",value:function(){var t=this,e=this.getCandle();e.body.forEach((function(e){var n=e.isWin?"candleWin":"candleLose";delete e.isWin,t.svgRect(e,n)})),e.shadow.forEach((function(e){var n=t.getPathFromPoints(e.top);n+=t.getPathFromPoints(e.bottom),t.svgPath(n,e.isWin?"candleWin":"candleLose")}))}},{key:"getCandle",value:function(){var t=l.get("points","candle"),e={body:[],shadow:[]};return t.forEach((function(t){e.body.push(u.candle(t)),e.shadow.push(u.candle(t,"shadow"))})),e}},{key:"drawSma",value:function(){var t=l.get("points","sma");this.svgPath(this.getPathFromPoints(t),"sma")}},{key:"drawEma",value:function(){var t=l.get("points","ema");this.svgPath(this.getPathFromPoints(t),"ema")}},{key:"getImage",value:function(){var t=l.get("area"),e=t.w,n=t.h;return{src:this.toBase64(),width:e,height:n}}},{key:"toggle",value:function(t){var e=!1;"candle"===t&&(t="candleWin",e=this.getId("candleLose"));var n=this.getId(t);n.style.display&&"block"!==n.style.display?(n.style.display="block",e&&(e.style.display="block")):(n.style.display="none",e&&(e.style.display="none"))}}])&&i(n.prototype,r),s&&i(n,s),e}(n(6));t.exports=s},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var u=n(0),s=n(1),f=n(2).config,h=n(7),p=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),window.getComputedStyle&&(this.elId=e,this.el=this.getId(e),this.snap=window.Snap("#"+e),this.setup())}var e,n,p;return e=t,(n=[{key:"setup",value:function(){this.init(),this.calc=new h}},{key:"init",value:function(){var t=window.getComputedStyle(this.el),e=t.height,n=t.width;n=s.f(n,0);var r=(e=s.f(e,0))-2*f.chart.paddingY;this.area={w:n,h:e,width:n-2*f.chart.paddingY,height:r,endX:n-f.chart.paddingX,zeroX:f.chart.paddingX,zeroY:e-f.chart.paddingY,ordinateX:f.chart.paddingX/2,offsetLeft:this.el.offsetLeft||this.el.parentElement.offsetLeft||0,offsetTop:this.el.offsetTop||this.el.parentElement.offsetTop||0,gridStep:s.f(r/f.chart.totalGrids,0)},u.set("area",this.area)}},{key:"data",value:function(t){if(!(t instanceof Array))throw new Error("Missing chart data !");u.save(t),this.calc.start(),this.calc.main()}},{key:"delete",value:function(t){Array.isArray(t)?t.forEach((function(t){return t&&t.remove()})):t.remove()}},{key:"deleteAll",value:function(){for(var t=this.el;t.firstChild;)t.removeChild(t.lastChild);this.groupCandle=!1}},{key:"drawAll",value:function(){this.drawAxis(),this.drawCandle(),this.drawLine(),this.drawSma(),this.drawEma()}},{key:"drawAxis",value:function(){this.drawLabelsX(),this.drawLabelsY()}},{key:"drawLabelsX",value:function(){var t=this,e=u.get("labels"),n=u.get("points","line"),r=Math.floor(this.area.zeroY+f.chart.paddingY/2);e.forEach((function(e,i){if(!(i%2&&n.length>f.chart.labelXskipLength)){var o=c(n[i],1)[0],a=s.fDate(e);t.svgText({point:[o,r],label:a,groupFlag:!0})}}))}},{key:"drawLabelsY",value:function(){var t=this,e=f.chart,n=e.enableGrid,r=e.totalGrids,i=this.area,o=i.endX,l=i.gridStep,u=this.calc.yAxis(),h=c(u.point,2),p=h[0],v=h[1],d=u.label,y=u.stepYValue,g="";a(Array(r+1)).forEach((function(){t.svgText({point:[p,v],label:d}),n&&(g+=t.getPath([p,v],[o,v])),v-=l,d=s.f(d+y)})),n&&this.svgPath(g,"grid")}},{key:"drawLine",value:function(){var t=u.get("points","line");this.svgPath(this.getPathFromPoints(t),"line")}},{key:"getPathFromPoints",value:function(t){for(var e=0,n="",r=t.length-1;e<r;e++)n+=this.getPath(t[e],t[e+1]),this.svgDebug(t[e]);return n}},{key:"getPath",value:function(t,e){var n="M".concat(Math.floor(t[0])," ").concat(Math.floor(t[1]));return n+="L".concat(Math.floor(e[0])," ").concat(Math.floor(e[1]))}},{key:"svgDebug",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];f.debug&&this.svgDot(t)}},{key:"svgRectGroup",value:function(){var t=f.svg.rectGroup,e=t.candleWin,n=t.candleLose;this.groupCandle={candleWin:this.snap.group().attr(e),candleLose:this.snap.group().attr(n)}}},{key:"svgDot",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"debug",n=arguments.length>2?arguments[2]:void 0,r=this.snap.circle({cx:t[0],cy:t[1],r:9});return n&&r.attr({id:n}),r.attr(f.svg.circle[e]||{})}},{key:"svgRect",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;this.groupCandle||this.svgRectGroup();var r=this.snap.rect(t);return this.isCandle(e)&&this.groupCandle[e].add(r),n&&r.attr({id:n}),r.attr(f.svg.rect[e]||{})}},{key:"svgText",value:function(t){var e=t.point,n=t.label,r=(t.groupFlag,arguments.length>1&&void 0!==arguments[1]&&arguments[1]),i=this.snap.text(e[0],e[1],n);return r&&i.attr({id:r}),i}},{key:"svgLine",value:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=(n=this.snap).line.apply(n,a(t).concat(a(e)));return r&&i.attr({id:r}),i.attr(f.svg.line)}},{key:"svgPath",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"line",n=this.snap.path(t).attr({stroke:"#".concat(f.colors[e])});this.isCandle(e)?n=this.groupCandle[e].add(n):"grid"===e?n.attr({"stroke-dasharray":"5,10"}):n.attr({id:e})}},{key:"isCandle",value:function(t){return["candleWin","candleLose"].includes(t)}},{key:"toBase64",value:function(){var t=(new XMLSerializer).serializeToString(this.el);return"data:image/svg+xml;base64,"+(t=btoa(t))}},{key:"liveMove",value:function(t){var e=this,n=0,r=u.get("area"),i=r.offsetLeft,o=r.offsetTop;this.snap.unclick(),this.snap.click((function(r,a,c){!n&&t("start",[a-i,c-o]),1==++n?(e.snap.unmousemove(),e.snap.mousemove((function(e,n,r){n%5||t("move",[n-i,r-o])}))):2===n&&(e.snap.unclick(),e.snap.unmousemove(),t("end"))}))}},{key:"liveDot",value:function(t,e,n){var r=u.get("area"),i=r.offsetLeft,o=r.offsetTop;t.drag((function(n,r,a,c){if(!(n%5&&r%5)){var l=[a-i,c-o];t.attr({cx:l[0],cy:l[1]}),e&&e(l)}}),(function(){}),(function(){n&&n()}))}},{key:"liveDotDelete",value:function(t){var e=["".concat(t,"-nav1"),"".concat(t,"-nav2")];return!!this.getId(e[0])&&(this.getId(e[0]).remove(),this.getId(e[1])&&this.getId(e[1]).remove(),!0)}},{key:"getId",value:function(t){return document.getElementById(t)}},{key:"getIdSnap",value:function(t){return this.snap.select("#".concat(t))}},{key:"getIdAttr",value:function(t,e){var n=this.getId(t);return e.reduce((function(t,e){return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(n,!0).forEach((function(e){o(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},t,o({},e,parseInt(n.getAttribute(e))))}),{})}},{key:"getElem",value:function(t,e){var n;return"root"===t?n=document.createElementNS("http://www.w3.org/2000/svg","foreignObject"):"div"===t?n=document.createElement("div"):"text"===t&&(n=document.createTextNode(e)),"object"===r(e)&&Object.keys(e).forEach((function(t){n.setAttribute(t,e[t])})),n}},{key:"textSvg",value:function(t,e){var n=this.getElem("root",{width:110,height:90,x:t[0],y:t[1],id:e,style:"cursor:pointer;"}),r=this.getElem("div",{contenteditable:!0,style:"color:black; background: white; opacity: 0.75;",class:"ltxt"}),i=this.getElem("text","Your comments");return r.appendChild(i),n.appendChild(r),this.snap.add(n)}}])&&l(e.prototype,n),p&&l(e,p),t}();t.exports=p},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var l=n(0),u=n(1),s=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o(this,a(e).apply(this,arguments))}var n,r,s;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(e,t),n=e,(r=[{key:"sma",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,e=l.get("data"),n=this.calcSma(e,t);l.mset({data:n,points:this.dataToPoints(n)},"sma")}},{key:"calcSma",value:function(t,e){var n=0;return t.map((function(r,i){return++i,n+=r,i>e&&(n-=t[i-1-e]),i<e?r:u.f(n/e)}))}},{key:"ema",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,e=l.get("data"),n=this.calcEma(e,t);l.mset({data:n,points:this.dataToPoints(n)},"ema")}},{key:"calcEma",value:function(t,e){var n=2/(e+1),r=1-n,i=t[0];return t.map((function(t,e){if(!e)return t;var o=t*n+i*r;return i=t,u.f(o)}))}},{key:"findY",value:function(t){var e=this.findYpixel(t);if(!e)return!1;var n=l.mget(["zeroY","stepY","minClose","area"]),r=(n.zeroY,n.stepY),i=n.minClose+(n.area.zeroY-e)/r;return{pixel:u.f(e,0),value:u.f(i)}}},{key:"findYpixel",value:function(t){var e=l.get("points","line"),n=e.findIndex((function(e){return e[0]>t}));if(n&&!(n<1)){var r=[e[n-1],e[n]],i=r[0],o=r[1],a=(o[1]-i[1])/(o[0]-i[0]),c=i[1]-a*i[0];return a*t+c}}},{key:"liveRect",value:function(t,e){if(!e)return{x:t[0],y:t[1],width:0,height:0};var n={};return t[0]>e.x?n.width=t[0]-e.x:(n.width=e.x-t[0],n.x=t[0]),t[1]>e.y?n.height=t[1]-e.y:(n.height=e.y-t[1],n.y=t[1]),n}},{key:"liveCircle",value:function(t,e){var n=Math.abs(e[0]-t[0]),r=Math.abs(e[1]-t[1]);return{r:n>r?n:r}}},{key:"livePointer",value:function(t){var e=this.findY(t[0]);return{x1:t[0],x2:t[0],y1:e.pixel,y2:t[1],foundY:e}}}])&&i(n.prototype,r),s&&i(n,s),e}(n(8));t.exports=s},function(t,e,n){function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var c=n(0),l=n(1),u=n(2).config,s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,s;return e=t,(n=[{key:"start",value:function(){this.init(),this.initSteps()}},{key:"main",value:function(){this.lines(),this.candle(),this.sma(),this.ema()}},{key:"init",value:function(){var t=c.get("raw"),e=o(t[0]);e.pop();var n={len:t.length,min:Math.min.apply(Math,o(e)),max:Math.max.apply(Math,o(e)),minClose:Math.min.apply(Math,o(e)),maxClose:Math.max.apply(Math,o(e)),amplitude:0,zero:e[3]};t.forEach((function(t){n.min>t[2]&&(n.min=t[2]),n.min>t[3]&&(n.min=t[3]),n.max<t[1]&&(n.max=t[1]),n.max<t[3]&&(n.max=t[3]),n.minClose>t[3]&&(n.minClose=t[3]),n.maxClose<t[3]&&(n.maxClose=t[3])})),n.amplitude=l.f(n.max-n.min),c.mset(n)}},{key:"initSteps",value:function(){var t=c.mget(["area","amplitude","len","zero","min"]),e=t.area,n=t.amplitude,r=t.len,i=t.zero,o=t.min,a=e.width/r,u=e.height/n,s=2*e.zeroX,f=e.zeroY-(i-o)*u;c.mset({stepX:l.f(a,0),stepY:l.f(u,0),zeroX:l.f(s,0),zeroY:l.f(f,0)})}},{key:"lines",value:function(){var t=c.get("data");c.set("points",this.dataToPoints(t),"line")}},{key:"dataToPoints",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=c.mget(["stepX","stepY","zeroX","zeroY"]),n=e.stepX,r=e.stepY,i=e.zeroX,o=e.zeroY,a={data:t[0],point:[i,o]};return t.map((function(t,e){if(!e)return a.point;var i=(t-a.data)*r,o=[a.point[0]+n,l.f(a.point[1]-i,0)];return a={data:t,point:o},o}))}},{key:"yAxis",value:function(){var t=c.mget(["amplitude","area","min"]),e=t.amplitude,n=t.area,r=t.min,i=u.chart.totalGrids,o=l.f(e*(1/i),7);return{point:[n.ordinateX,n.zeroY],label:l.f(r),stepYValue:o}}},{key:"candle",value:function(){var t=this,e=c.mget(["stepX","stepY","raw"]),n=e.stepX,r=e.stepY,i=e.raw,o=c.get("points","line"),a=u.chart.candleFill,s=l.f(n*a,0);o.forEach((function(e,a){if(a>0){var c={prevPoint:o[a-1],point:e};t.candleBody(c,{candleWidth:s,stepX:n,stepY:r,ohlc:{Open:i[a][0],High:i[a][1],Low:i[a][2],Close:i[a][3]}})}}))}},{key:"candleBody",value:function(t,e){var n=t.prevPoint,r=t.point,i=e.candleWidth,o=e.stepX,a={x:0,y:r[1]>n[1]?n[1]:r[1],width:i,height:Math.abs(r[1]-n[1]),xCenter:l.f(r[0]-o/2,0),isWin:n[1]>r[1]};a.x=l.f(a.xCenter-i/2,0),this.candleShadow(t,e,a)}},{key:"candleShadow",value:function(t,e,n){var o,a,u=t.prevPoint,s=t.point,f=e.stepY,h=e.ohlc,p=h.Open,v=h.High,d=h.Low,y=h.Close,g=n.y,m=n.xCenter,b=n.isWin,w={top:[[m,g],[m,g]],bottom:[[m,u[1]],[m,u[1]]],isWin:b};b?(o=v-y,a=p-d):(o=v-p,a=y-d,w.bottom[0][1]=s[1],w.bottom[1][1]=s[1]),w.top[1][1]-=l.f(o*f,0),w.bottom[1][1]+=l.f(a*f,0),c.push("candle.points",function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(n,!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},n,{},w))}}])&&a(e.prototype,n),s&&a(e,s),t}();t.exports=s}])}));